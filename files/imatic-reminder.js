!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){$(document).ready((function(){$(".modal-recipients-select").select2();const e=$(".widget-toolbox a"),t=$("#imatic-reminder-close-modal");function n(){$("#imatic-reminder-modal").toggleClass("show")}e.each((function(){if($(this).attr("href").includes("imatic_remind_issue.php")){$("#count-reminders").data("count")>0&&$(this).removeClass("btn-primary").addClass("btn-warning"),$(this).on("click",(function(e){e.preventDefault(),n()}))}})),t.on("click",(function(e){e.preventDefault(),n()})),$(".close").on("click",(function(){n()})),$(".other-button").on("click",(function(){n()}))}))},function(e,t,n){"use strict";n.r(t);n(0);function r(e,t,n=2e3){let r=document.createElement("div");r.style.position="fixed",r.style.top="50%",r.style.left="50%",r.style.padding="20px",r.style.border="1px solid white",r.style.borderRadius="5px",r.style.zIndex="9999",r.style.color="black",r.style.display="block",r.style.backgroundColor=t,r.textContent=e,document.body.appendChild(r),setTimeout((function(){r.style.display="none"}),n)}function o(e,t="POST"){return fetch(e.get("action"),{method:t,body:e}).then(e=>{if(!e.ok)throw r("Response was not ok","red"),new Error("Response was not ok");return e.text()}).then(e=>{let t=JSON.parse(e);return 200===t.status?(r(t.message,"#DEF1D8"),!0):(r(t.message,"red"),!1)}).catch(e=>(console.error("There has been a problem with your fetch operation:",e),Promise.reject(e)))}function a(){let e=document.querySelectorAll(".edit-reminder"),t=document.querySelectorAll(".delete-reminder");e.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("data-id"),n=this.getAttribute("data-action");let r=document.getElementById("reminder-table-"+t),a=new FormData;r.querySelectorAll("input, textarea").forEach((function(e){a.append(e.name,e.value)})),a.append("action",n);const i=r.querySelector(".fa-check");i&&(i.classList.remove("fa-check","text-success"),i.classList.add("fa-close","text-danger")),o(a)}))})),t.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("data-id"),n=this.getAttribute("data-action");let r=document.getElementById("reminder-table-"+t),a=new FormData;r.querySelectorAll("input, textarea").forEach((function(e){a.append(e.name,e.value)})),a.append("action",n),o(a).then(e=>{e&&r&&r.remove()})}))}))}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("imatic-reminder-create-form").addEventListener("submit",(function(e){e.preventDefault();let t=new FormData(this),n=this.getAttribute("action");t.append("action",n),fetch(n,{method:"POST",body:t}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>{if(e&&200===e.status){r(e.message,"#DEF1D8"),document.getElementById("remind_at").value="",document.getElementById("comment").value="";let t=document.getElementById("reminders-table"),n=document.createElement("tbody");e.reminders.forEach((function(e){let r=document.createElement("tr");r.id="reminder-table-"+e.id,r.innerHTML=`\n                            <td>${e.id}</td>\n                            <td>${e.username}</td>\n                            <td>\n                                <input type="datetime-local" name="remind_at" class="form-control" value="${e.remind_at}"></td>\n                            <td>\n                                <textarea name="message" class="form-control" rows="1" cols="20">${e.message}</textarea>\n                            </td>\n                            <td class="text-center"><i class="fa fa-close text-danger" /></td>\n                            <td>\n                                <button type="button" class="btn btn-primary btn-xs edit-reminder" data-id="${e.id}"\n                                        data-action="${e.edit_action}">\n                                    <i class="fa fa-edit"></i>\n                                </button>\n                                <button type="button" class="btn btn-danger btn-xs delete-reminder" data-id="${e.id}"\n                                        data-action="${e.delete_action}">\n                                    <i class="fa fa-trash" aria-hidden="true"></i>\n                                </button>\n                                <input type="hidden" name="id" value="${e.id}">\n                                <input type="hidden" name="user_id" value="${e.user_id}">\n                            </td>\n                        `,n.appendChild(r),t.appendChild(n)})),a()}else r("An error occurred","red")}).catch(e=>{console.error("There has been a problem with your fetch operation:",e)})})),a()})),flatpickr("#remind_at",{enableTime:!0,dateFormat:"Y-m-d H:i",time_24hr:!0,minuteIncrement:15,locale:"cs",allowInput:!0})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vanMvZmlsZXMvcmVtaW5kZXItbW9kYWwuanMiLCJ3ZWJwYWNrOi8vLy4vanMvZmlsZXMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4vanMvZmlsZXMvcmVtaW5kZXItYWN0aW9ucy5qcyIsIndlYnBhY2s6Ly8vLi9qcy9pbmRleC5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIiQiLCJkb2N1bWVudCIsInJlYWR5Iiwic2VsZWN0MiIsInRvb2xCb3giLCJjbG9zZU1vZGFsQnV0dG9uIiwidG9nZ2xlSW1hdGljUmVtaW5kZXJNb2RhbCIsInRvZ2dsZUNsYXNzIiwiZWFjaCIsInRoaXMiLCJhdHRyIiwiaW5jbHVkZXMiLCJkYXRhIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsIm9uIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2hvd01lc3NhZ2VzIiwibWVzc2FnZSIsImNvbG9yIiwidGltZW91dCIsIm1lc3NhZ2VDb250YWluZXIiLCJjcmVhdGVFbGVtZW50Iiwic3R5bGUiLCJwb3NpdGlvbiIsInRvcCIsImxlZnQiLCJwYWRkaW5nIiwiYm9yZGVyIiwiYm9yZGVyUmFkaXVzIiwiekluZGV4IiwiZGlzcGxheSIsImJhY2tncm91bmRDb2xvciIsInRleHRDb250ZW50IiwiYm9keSIsImFwcGVuZENoaWxkIiwic2V0VGltZW91dCIsInNlbmRGb3JtRGF0YSIsImZvcm0iLCJtZXRob2QiLCJmZXRjaCIsInRoZW4iLCJyZXNwb25zZSIsIm9rIiwiRXJyb3IiLCJ0ZXh0IiwiZGF0YU9iaiIsIkpTT04iLCJwYXJzZSIsInN0YXR1cyIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwiUHJvbWlzZSIsInJlamVjdCIsImFkZEV2ZW50TGlzdGVuZXJzVG9CdXR0b25zIiwiZWRpdEJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZGVsZXRlQnV0dG9ucyIsImZvckVhY2giLCJidXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwicmVtaW5kZXJJZCIsImdldEF0dHJpYnV0ZSIsImFjdGlvbiIsInRhYmxlIiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiaW5wdXQiLCJhcHBlbmQiLCJpY29uIiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsInJlc3VsdCIsImpzb24iLCJ0Ym9keSIsInJlbWluZGVycyIsInJvd0RhdGEiLCJyb3ciLCJpZCIsImlubmVySFRNTCIsInVzZXJuYW1lIiwicmVtaW5kX2F0IiwiZWRpdF9hY3Rpb24iLCJkZWxldGVfYWN0aW9uIiwidXNlcl9pZCIsImZsYXRwaWNrciIsImVuYWJsZVRpbWUiLCJkYXRlRm9ybWF0IiwidGltZV8yNGhyIiwibWludXRlSW5jcmVtZW50IiwibG9jYWxlIiwiYWxsb3dJbnB1dCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVB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QUFJQyxHQUFLLGtCQUFvQkYsRUFBUUUsR0FFckNELEVBQUlFLFVBQVkscUNBQ05ILEVBQVFFLDRDQUNSRixFQUFRSSw4SkFFa0VKLEVBQVFLLHdKQUVqQkwsRUFBUTlELHdTQUlHOEQsRUFBUUUsNkRBQy9ERixFQUFRTSwwT0FHZ0ROLEVBQVFFLDZEQUNoRUYsRUFBUU8seU5BR1NQLEVBQVFFLG9GQUNIRixFQUFRUSx5RUFHN0RWLEVBQU0zQyxZQUFZOEMsR0FFbEJoQixFQUFNOUIsWUFBWTJDLE1BR3RCdkIsU0FHQXRDLEVBQWEsb0JBQXFCLFNBR3pDaUMsTUFBTUMsSUFDSEMsUUFBUUQsTUFBTSxzREFBdURBLFFBR2pGSSxPQzNISmtDLFVBQVUsYUFBYyxDQUNwQkMsWUFBWSxFQUNaQyxXQUFZLFlBQ1pDLFdBQVcsRUFDWEMsZ0JBQWlCLEdBQ2pCQyxPQUFRLEtBQ1JDLFlBQVkiLCJmaWxlIjoiaW1hdGljLXJlbWluZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuXG4gICAgJCgnLm1vZGFsLXJlY2lwaWVudHMtc2VsZWN0Jykuc2VsZWN0MigpO1xuXG4gICAgY29uc3QgdG9vbEJveCA9ICQoJy53aWRnZXQtdG9vbGJveCBhJyk7XG4gICAgY29uc3QgY2xvc2VNb2RhbEJ1dHRvbiA9ICQoJyNpbWF0aWMtcmVtaW5kZXItY2xvc2UtbW9kYWwnKVxuXG4gICAgdG9vbEJveC5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlSHJlZiA9ICQodGhpcykuYXR0cignaHJlZicpO1xuICAgICAgICBpZiAoYXR0cmlidXRlSHJlZi5pbmNsdWRlcygnaW1hdGljX3JlbWluZF9pc3N1ZS5waHAnKSkge1xuICAgICAgICAgICAgY29uc3QgcmVtaW5kZXJDb3VudCA9ICQoJyNjb3VudC1yZW1pbmRlcnMnKS5kYXRhKCdjb3VudCcpO1xuICAgICAgICAgICAgaWYgKHJlbWluZGVyQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYnRuLXByaW1hcnknKS5hZGRDbGFzcygnYnRuLXdhcm5pbmcnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJCh0aGlzKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgICAgIHRvZ2dsZUltYXRpY1JlbWluZGVyTW9kYWwoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgZnVuY3Rpb24gdG9nZ2xlSW1hdGljUmVtaW5kZXJNb2RhbCgpIHtcbiAgICAgICAgY29uc3QgaW1hdGljUmVtaW5kZXJNb2RhbCA9ICQoJyNpbWF0aWMtcmVtaW5kZXItbW9kYWwnKTtcbiAgICAgICAgaW1hdGljUmVtaW5kZXJNb2RhbC50b2dnbGVDbGFzcyhcInNob3dcIik7XG4gICAgfVxuXG4gICAgY2xvc2VNb2RhbEJ1dHRvbi5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgdG9nZ2xlSW1hdGljUmVtaW5kZXJNb2RhbCgpO1xuICAgIH0pXG5cblxuICAgICQoJy5jbG9zZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdG9nZ2xlSW1hdGljUmVtaW5kZXJNb2RhbCgpO1xuICAgIH0pO1xuXG4gICAgJCgnLm90aGVyLWJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdG9nZ2xlSW1hdGljUmVtaW5kZXJNb2RhbCgpO1xuICAgIH0pO1xufSk7XG5cbiIsImV4cG9ydCBmdW5jdGlvbiBzaG93TWVzc2FnZXMobWVzc2FnZSwgY29sb3IsIHRpbWVvdXQgPSAyMDAwKSB7XG4gICAgbGV0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUudG9wID0gJzUwJSc7XG4gICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gJzUwJSc7XG4gICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5wYWRkaW5nID0gJzIwcHgnO1xuICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB3aGl0ZSc7XG4gICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNXB4JztcbiAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLnpJbmRleCA9ICc5OTk5JztcbiAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmNvbG9yID0gJ2JsYWNrJztcbiAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgbWVzc2FnZUNvbnRhaW5lci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG5cbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1lc3NhZ2VDb250YWluZXIpO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9LCB0aW1lb3V0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRGb3JtRGF0YShmb3JtLCBtZXRob2QgPSAnUE9TVCcpIHtcblxuICAgIHJldHVybiBmZXRjaChmb3JtLmdldCgnYWN0aW9uJyksIHtcbiAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgIGJvZHk6IGZvcm1cbiAgICB9KVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgc2hvd01lc3NhZ2VzKCdSZXNwb25zZSB3YXMgbm90IG9rJywgXCJyZWRcIik7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXNwb25zZSB3YXMgbm90IG9rJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgIGxldCBkYXRhT2JqID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgIGlmIChkYXRhT2JqLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgc2hvd01lc3NhZ2VzKGRhdGFPYmoubWVzc2FnZSwgXCIjREVGMUQ4XCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzaG93TWVzc2FnZXMoZGF0YU9iai5tZXNzYWdlLCBcInJlZFwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUaGVyZSBoYXMgYmVlbiBhIHByb2JsZW0gd2l0aCB5b3VyIGZldGNoIG9wZXJhdGlvbjonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbn0iLCJpbXBvcnQge3Nob3dNZXNzYWdlc30gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQge3NlbmRGb3JtRGF0YX0gZnJvbSAnLi91dGlscyc7XG5mdW5jdGlvbiBhZGRFdmVudExpc3RlbmVyc1RvQnV0dG9ucygpIHtcbiAgICBsZXQgZWRpdEJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdC1yZW1pbmRlcicpO1xuICAgIGxldCBkZWxldGVCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRlbGV0ZS1yZW1pbmRlcicpO1xuXG4gICAgZWRpdEJ1dHRvbnMuZm9yRWFjaChmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIGNvbnN0IHJlbWluZGVySWQgPSB0aGlzLmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG4gICAgICAgICAgICBjb25zdCBhY3Rpb24gPSB0aGlzLmdldEF0dHJpYnV0ZShcImRhdGEtYWN0aW9uXCIpO1xuICAgICAgICAgICAgbGV0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlbWluZGVyLXRhYmxlLScgKyByZW1pbmRlcklkKTtcblxuICAgICAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgICAgICB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgdGV4dGFyZWEnKS5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChpbnB1dC5uYW1lLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnYWN0aW9uJywgYWN0aW9uKTtcblxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3IoJy5mYS1jaGVjaycpO1xuICAgICAgICAgICAgaWYgKGljb24pIHtcbiAgICAgICAgICAgICAgICBpY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2ZhLWNoZWNrJywgJ3RleHQtc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgIGljb24uY2xhc3NMaXN0LmFkZCgnZmEtY2xvc2UnLCAndGV4dC1kYW5nZXInKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2VuZEZvcm1EYXRhKGZvcm1EYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZWxldGVCdXR0b25zLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cbiAgICAgICAgICAgIGNvbnN0IHJlbWluZGVySWQgPSB0aGlzLmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWFjdGlvblwiKTtcbiAgICAgICAgICAgIGxldCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1pbmRlci10YWJsZS0nICsgcmVtaW5kZXJJZCk7XG5cbiAgICAgICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgdGFibGUucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHRleHRhcmVhJykuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoaW5wdXQubmFtZSwgaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2FjdGlvbicsIGFjdGlvbik7XG5cbiAgICAgICAgICAgIHNlbmRGb3JtRGF0YShmb3JtRGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAgIGxldCByZW1pbmRlckNyZWF0ZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hdGljLXJlbWluZGVyLWNyZWF0ZS1mb3JtJyk7XG5cbiAgICByZW1pbmRlckNyZWF0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSh0aGlzKTtcbiAgICAgICAgbGV0IGFjdGlvbiA9IHRoaXMuZ2V0QXR0cmlidXRlKCdhY3Rpb24nKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdhY3Rpb24nLCBhY3Rpb24pO1xuXG4gICAgICAgIGZldGNoKGFjdGlvbiwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBmb3JtRGF0YVxuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOZXR3b3JrIHJlc3BvbnNlIHdhcyBub3Qgb2snKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3dNZXNzYWdlcyhkYXRhLm1lc3NhZ2UsIFwiI0RFRjFEOFwiKTtcblxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVtaW5kX2F0JykudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbW1lbnQnKS52YWx1ZSA9ICcnO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZW1pbmRlcnMtdGFibGUnKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRib2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJvd3MgPSBkYXRhLnJlbWluZGVycztcblxuICAgICAgICAgICAgICAgICAgICByb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvd0RhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93LmlkID0gJ3JlbWluZGVyLXRhYmxlLScgKyByb3dEYXRhLmlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByb3cuaW5uZXJIVE1MID0gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke3Jvd0RhdGEuaWR9PC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtyb3dEYXRhLnVzZXJuYW1lfTwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImRhdGV0aW1lLWxvY2FsXCIgbmFtZT1cInJlbWluZF9hdFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCIgdmFsdWU9XCIke3Jvd0RhdGEucmVtaW5kX2F0fVwiPjwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dGFyZWEgbmFtZT1cIm1lc3NhZ2VcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIHJvd3M9XCIxXCIgY29scz1cIjIwXCI+JHtyb3dEYXRhLm1lc3NhZ2V9PC90ZXh0YXJlYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cInRleHQtY2VudGVyXCI+PGkgY2xhc3M9XCJmYSBmYS1jbG9zZSB0ZXh0LWRhbmdlclwiIC8+PC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi14cyBlZGl0LXJlbWluZGVyXCIgZGF0YS1pZD1cIiR7cm93RGF0YS5pZH1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYWN0aW9uPVwiJHtyb3dEYXRhLmVkaXRfYWN0aW9ufVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1lZGl0XCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWRhbmdlciBidG4teHMgZGVsZXRlLXJlbWluZGVyXCIgZGF0YS1pZD1cIiR7cm93RGF0YS5pZH1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEtYWN0aW9uPVwiJHtyb3dEYXRhLmRlbGV0ZV9hY3Rpb259XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXRyYXNoXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiaWRcIiB2YWx1ZT1cIiR7cm93RGF0YS5pZH1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwidXNlcl9pZFwiIHZhbHVlPVwiJHtyb3dEYXRhLnVzZXJfaWR9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChyb3cpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0Ym9keSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnRMaXN0ZW5lcnNUb0J1dHRvbnMoKVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvd01lc3NhZ2VzKCdBbiBlcnJvciBvY2N1cnJlZCcsIFwicmVkXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RoZXJlIGhhcyBiZWVuIGEgcHJvYmxlbSB3aXRoIHlvdXIgZmV0Y2ggb3BlcmF0aW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH0pXG4gICAgYWRkRXZlbnRMaXN0ZW5lcnNUb0J1dHRvbnMoKVxufSkiLCJcbmltcG9ydCAnLi9maWxlcy9yZW1pbmRlci1tb2RhbC5qcydcbmltcG9ydCAnLi9maWxlcy9yZW1pbmRlci1hY3Rpb25zLmpzJ1xuXG5mbGF0cGlja3IoXCIjcmVtaW5kX2F0XCIsIHtcbiAgICBlbmFibGVUaW1lOiB0cnVlLFxuICAgIGRhdGVGb3JtYXQ6IFwiWS1tLWQgSDppXCIsXG4gICAgdGltZV8yNGhyOiB0cnVlLFxuICAgIG1pbnV0ZUluY3JlbWVudDogMTUsXG4gICAgbG9jYWxlOiAnY3MnLFxuICAgIGFsbG93SW5wdXQ6IHRydWVcbn0pOyJdLCJzb3VyY2VSb290IjoiIn0=